# Test minimal cmake MLIR project
# REQUIRES: mlir-translate
# RUN: rm -rf %t
# RUN: mkdir -p %t/_build
# RUN: cat %s > %t/CMakeLists.txt
# RUN: cd %t/_build && %cmake ..  -DMLIR_DIR=`%llvm-config --libdir`/cmake/mlir -DLLVM_DIR=`%llvm-config --libdir`/cmake/llvm && cmake --build .

cmake_minimum_required(VERSION 3.18.0)
project(mlir_out_of_tree)

find_package(MLIR REQUIRED CONFIG)

list(APPEND CMAKE_MODULE_PATH "${MLIR_CMAKE_DIR}")
list(APPEND CMAKE_MODULE_PATH "${LLVM_CMAKE_DIR}")

include(TableGen)
include(AddLLVM)
include(AddMLIR)
include(HandleLLVMOptions)
include(MLIRDetectPythonEnv)

add_mlir_aggregate(aggregator
SHARED
EMBED_LIBS
MLIRCAPIIR
MLIRCAPIRegistration
)
